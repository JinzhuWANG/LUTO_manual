Traceback (most recent call last):
  File "f:\jinzhu\conda_env\luto\Lib\site-packages\jupyter_cache\executors\utils.py", line 58, in single_nb_execution
    executenb(
  File "f:\jinzhu\conda_env\luto\Lib\site-packages\nbclient\client.py", line 1314, in execute
    return NotebookClient(nb=nb, resources=resources, km=km, **kwargs).execute()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "f:\jinzhu\conda_env\luto\Lib\site-packages\jupyter_core\utils\__init__.py", line 165, in wrapped
    return loop.run_until_complete(inner)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "f:\jinzhu\conda_env\luto\Lib\asyncio\base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "f:\jinzhu\conda_env\luto\Lib\site-packages\nbclient\client.py", line 709, in async_execute
    await self.async_execute_cell(
  File "f:\jinzhu\conda_env\luto\Lib\site-packages\nbclient\client.py", line 1062, in async_execute_cell
    await self._check_raise_for_error(cell, cell_index, exec_reply)
  File "f:\jinzhu\conda_env\luto\Lib\site-packages\nbclient\client.py", line 918, in _check_raise_for_error
    raise CellExecutionError.from_cell_and_msg(cell, exec_reply_content)
nbclient.exceptions.CellExecutionError: An error occurred while executing the following cell:
------------------
# REMOVE

'''
Here are the code to run LUTO first, so that we can have the variables and objects required for illustration in the notebook.
'''

# Reload all modules before excuting each cell, so that we can modify the imported custom functions on-the-fly without rerun the whole model.
%load_ext autoreload
%autoreload 2


# Imports
import os
import xarray as xr
import numpy as np
import pandas as pd
import matplotlib.pyplot as plt
import plotnine as p9
import geopandas as gpd


from rasterstats import zonal_stats
from mizani.formatters import scientific_format


# cd to the root folder of LUTO project
os.chdir('N:/LUF-Modelling/LUTO2_JZ/luto-2.0')
from luto.tools.Manual_jupyter_books.helpers import map_to_4band, mrj_to_xr, arr_to_xr, map_to_plot
from luto.economics.agricultural.quantity import get_quantity_matrices
from luto.economics.agricultural.water import get_wreq_matrices
from luto.tools.Manual_jupyter_books.helpers.parameters import legend_params


# # Run LUTO
# import luto.simulation as sim
# data = sim.load_data()
# sim.run(data=data, base=2010, target=2050)
------------------


[1;31m---------------------------------------------------------------------------[0m
[1;31mImportError[0m                               Traceback (most recent call last)
Cell [1;32mIn[1], line 28[0m
[0;32m     26[0m [38;5;66;03m# cd to the root folder of LUTO project[39;00m
[0;32m     27[0m os[38;5;241m.[39mchdir([38;5;124m'[39m[38;5;124mN:/LUF-Modelling/LUTO2_JZ/luto-2.0[39m[38;5;124m'[39m)
[1;32m---> 28[0m [38;5;28;01mfrom[39;00m [38;5;21;01mluto[39;00m[38;5;21;01m.[39;00m[38;5;21;01mtools[39;00m[38;5;21;01m.[39;00m[38;5;21;01mManual_jupyter_books[39;00m[38;5;21;01m.[39;00m[38;5;21;01mhelpers[39;00m [38;5;28;01mimport[39;00m map_to_4band, mrj_to_xr, arr_to_xr, map_to_plot
[0;32m     29[0m [38;5;28;01mfrom[39;00m [38;5;21;01mluto[39;00m[38;5;21;01m.[39;00m[38;5;21;01meconomics[39;00m[38;5;21;01m.[39;00m[38;5;21;01magricultural[39;00m[38;5;21;01m.[39;00m[38;5;21;01mquantity[39;00m [38;5;28;01mimport[39;00m get_quantity_matrices
[0;32m     30[0m [38;5;28;01mfrom[39;00m [38;5;21;01mluto[39;00m[38;5;21;01m.[39;00m[38;5;21;01meconomics[39;00m[38;5;21;01m.[39;00m[38;5;21;01magricultural[39;00m[38;5;21;01m.[39;00m[38;5;21;01mwater[39;00m [38;5;28;01mimport[39;00m get_wreq_matrices

File [1;32mN:\LUF-Modelling\LUTO2_JZ\luto-2.0\luto\tools\__init__.py:41[0m
[0;32m     37[0m [38;5;28;01mfrom[39;00m [38;5;21;01mdatetime[39;00m [38;5;28;01mimport[39;00m datetime
[0;32m     38[0m [38;5;28;01mfrom[39;00m [38;5;21;01mjoblib[39;00m [38;5;28;01mimport[39;00m Parallel, delayed
[1;32m---> 41[0m [38;5;28;01mfrom[39;00m [38;5;21;01mluto[39;00m[38;5;21;01m.[39;00m[38;5;21;01mtools[39;00m[38;5;21;01m.[39;00m[38;5;21;01mreport[39;00m[38;5;21;01m.[39;00m[38;5;21;01mcreate_html[39;00m [38;5;28;01mimport[39;00m data2html
[0;32m     42[0m [38;5;28;01mfrom[39;00m [38;5;21;01mluto[39;00m[38;5;21;01m.[39;00m[38;5;21;01mtools[39;00m[38;5;21;01m.[39;00m[38;5;21;01mreport[39;00m[38;5;21;01m.[39;00m[38;5;21;01mcreate_report_data[39;00m [38;5;28;01mimport[39;00m save_report_data
[0;32m     43[0m [38;5;28;01mfrom[39;00m [38;5;21;01mluto[39;00m[38;5;21;01m.[39;00m[38;5;21;01mtools[39;00m[38;5;21;01m.[39;00m[38;5;21;01mreport[39;00m[38;5;21;01m.[39;00m[38;5;21;01mcreate_static_maps[39;00m [38;5;28;01mimport[39;00m TIF2MAP

File [1;32mN:\LUF-Modelling\LUTO2_JZ\luto-2.0\luto\tools\report\create_html.py:7[0m
[0;32m      4[0m [38;5;28;01mfrom[39;00m [38;5;21;01mglob[39;00m [38;5;28;01mimport[39;00m glob
[0;32m      6[0m [38;5;28;01mfrom[39;00m [38;5;21;01mluto[39;00m[38;5;21;01m.[39;00m[38;5;21;01mtools[39;00m[38;5;21;01m.[39;00m[38;5;21;01mreport[39;00m[38;5;21;01m.[39;00m[38;5;21;01mdata_tools[39;00m [38;5;28;01mimport[39;00m get_all_files
[1;32m----> 7[0m [38;5;28;01mfrom[39;00m [38;5;21;01mluto[39;00m[38;5;21;01m.[39;00m[38;5;21;01mtools[39;00m[38;5;21;01m.[39;00m[38;5;21;01mreport[39;00m[38;5;21;01m.[39;00m[38;5;21;01mdata_tools[39;00m[38;5;21;01m.[39;00m[38;5;21;01mhelper_func[39;00m [38;5;28;01mimport[39;00m add_data_2_html, add_txt_2_html
[0;32m      8[0m [38;5;28;01mfrom[39;00m [38;5;21;01mluto[39;00m[38;5;21;01m.[39;00m[38;5;21;01mtools[39;00m[38;5;21;01m.[39;00m[38;5;21;01mreport[39;00m[38;5;21;01m.[39;00m[38;5;21;01mdata_tools[39;00m[38;5;21;01m.[39;00m[38;5;21;01mparameters[39;00m [38;5;28;01mimport[39;00m SPATIAL_MAP_DICT, RENAME_AM_NON_AG
[0;32m     12[0m [38;5;66;03m####################################################[39;00m
[0;32m     13[0m [38;5;66;03m#         setting up working variables             #[39;00m
[0;32m     14[0m [38;5;66;03m####################################################[39;00m

File [1;32mN:\LUF-Modelling\LUTO2_JZ\luto-2.0\luto\tools\report\data_tools\helper_func.py:2[0m
[0;32m      1[0m [38;5;28;01mimport[39;00m [38;5;21;01mos[39;00m
[1;32m----> 2[0m [38;5;28;01mfrom[39;00m [38;5;21;01mlxml[39;00m [38;5;28;01mimport[39;00m etree
[0;32m      3[0m [38;5;28;01mfrom[39;00m  [38;5;21;01mlxml[39;00m[38;5;21;01m.[39;00m[38;5;21;01metree[39;00m [38;5;28;01mimport[39;00m Element
[0;32m      7[0m [38;5;28;01mdef[39;00m [38;5;21mlist_all_files[39m(directory):

[1;31mImportError[0m: DLL load failed while importing etree: Access is denied.

